<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clash Imposter / Custom Word Imposter</title>
  <style>
    :root{
      --bg:#0f172a; --panel:#111827; --text:#e5e7eb; --muted:#94a3b8;
      --accent:#22c55e; --danger:#ef4444; --btn:#1f2937; --link:#38bdf8;
    }
    *{box-sizing:border-box;font-family:system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
    body{margin:0;background:linear-gradient(180deg,#0b1220,#0f172a);color:var(--text);min-height:100dvh;display:flex;align-items:center}
    .wrap{width:100%;max-width:720px;margin:0 auto;padding:20px}
    .card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:20px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    h1{font-size:28px;margin:0 0 8px}
    p.sub{margin:0 0 18px;color:var(--muted)}
    label{display:block;margin:10px 0 4px;color:var(--muted);font-size:14px}
    input,textarea,select{width:100%;padding:12px 14px;border-radius:12px;border:1px solid rgba(255,255,255,0.1);background:var(--panel);color:var(--text)}
    textarea{min-height:110px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{width:100%;padding:14px 16px;border-radius:14px;border:1px solid rgba(255,255,255,.1);background:var(--btn);color:var(--text);font-weight:700;font-size:16px}
    .btn.primary{background:#0ea5e9;border-color:rgba(14,165,233,.5)}
    .btn.success{background:var(--accent);color:#052e16;border:none}
    .btn.danger{background:var(--danger);border:none}
    .stack{display:flex;flex-direction:column;gap:10px}
    .center{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;gap:14px}
    .big{font-size:42px;font-weight:800}
    .pill{padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);font-size:12px;color:var(--muted)}
    .divider{height:1px;background:rgba(255,255,255,.08);margin:10px 0}
    .muted{color:var(--muted)}
    .hidden{display:none}
    .wordCard{border-radius:24px;border:2px dashed rgba(255,255,255,.2);padding:26px;min-height:120px}
    .mode-switch{display:flex;gap:10px;flex-wrap:wrap}
    .mode-btn{padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(56,189,248,.1);color:#c7f9ff;font-weight:700;cursor:pointer}
    .mode-btn.active{background:#38bdf8;color:#032230}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Setup Screen -->
    <div class="card" id="screen-setup">
      <div class="mode-switch">
        <button class="mode-btn active" id="modeClash">Clash Imposter</button>
        <button class="mode-btn" id="modeCustom">Custom Word Imposter</button>
      </div>
      <h1 id="title">Clash Imposter</h1>
      <p class="sub">One phone. Most players see the same word. Some see <b>IMPOSTOR</b>. Tap to reveal â†’ tap again for next player.</p>

      <div class="row">
        <div>
          <label>Players</label>
          <input id="players" type="number" min="3" max="20" value="6" />
        </div>
        <div>
          <label>Impostors (max = players)</label>
          <input id="impostors" type="number" min="1" value="1" />
        </div>
      </div>

      <label id="wordsLabel">Word list</label>
      <textarea id="words"></textarea>

      <div class="row" style="margin-top:12px">
        <button class="btn" id="randomize">Shuffle List</button>
        <button class="btn primary" id="start">Start Round</button>
      </div>

      <div class="divider"></div>
      <p class="muted">Tip: In Clash mode the word list auto-fills with **all Clash Royale cards**. Switch to Custom mode to edit your own list.</p>
    </div>

    <!-- Pass & reveal screen -->
    <div class="card hidden" id="screen-pass">
      <div class="center">
        <div class="pill" id="turnInfo">Player 1 / ?</div>
        <div class="wordCard center">
          <div class="big" id="revealText">Tap to reveal</div>
          <div class="muted" id="hint">Hand the phone to this player before tapping.</div>
        </div>
        <button class="btn success" id="toggleBtn" style="width:100%">Reveal</button>
      </div>
      <div class="divider"></div>
      <div class="stack">
        <button class="btn" id="endRound">End Round / New Word</button>
        <button class="btn danger" id="resetAll">Reset Game</button>
      </div>
    </div>

    <!-- Summary screen -->
    <div class="card hidden" id="screen-summary">
      <div class="center">
        <div class="pill">Round finished</div>
        <div id="summaryWord" class="big"></div>
        <div id="summaryList" class="muted"></div>
        <div class="stack" style="width:100%;max-width:420px">
          <div id="revealHint" class="muted">Tap to reveal impostors</div>
          <div id="impostorReveal" class="muted hidden"></div>
          <button class="btn primary" id="playAgain">Play Again</button>
        </div>
          <button class="btn primary" id="playAgain">Play Again</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- Utilities ---
    const el = id => document.getElementById(id);
    const screens = { setup: el('screen-setup'), pass: el('screen-pass'), summary: el('screen-summary') };
    function show(name){ Object.values(screens).forEach(s=>s.classList.add('hidden')); screens[name].classList.remove('hidden'); }

    // --- Clash Royale card list (as of common sets) ---
    const CLASH_CARDS = [
      'Arrows','Zap','Snowball','Rage','Clone','Mirror','Heal Spirit','Fireball','Poison','Rocket','Lightning','Earthquake','Tornado','The Log','Barbarian Barrel','Royal Delivery',
      'Skeletons','Ice Spirit','Fire Spirits','Bats','Spear Goblins','Goblins','Goblin Gang','Guards','Skeleton Army','Wall Breakers',
      'Archers','Knight','Bomber','Ice Golem','Minions','Minion Horde','Dart Goblin','Goblin Cage','Goblin Hut','Barbarian Hut','Barbarians','Royal Recruits','Royal Hogs','Zappies','Rascals',
      'Musketeer','Hunter','Wizard','Ice Wizard','Electro Wizard','Magic Archer','Mother Witch',
      'Valkyrie','Mini P.E.K.K.A','Dark Prince','Prince','Bandit','Battle Ram','Cannon Cart','Ram Rider','Lumberjack','Battle Healer','Fisherman','Monk',
      'P.E.K.K.A','Giant','Giant Skeleton','Goblin Giant','Royal Giant','Hog Rider','Mega Knight','Sparky','Balloon','X-Bow','Mortar','Cannon','Bomb Tower','Tesla','Inferno Tower','Furnace','Tombstone',
      'Baby Dragon','Inferno Dragon','Electro Dragon','Skeleton Dragons','Phoenix',
      'Mega Minion','Minion Horde','Flying Machine',
      'Golem','Lava Hound','Graveyard','Miner','Goblin Barrel','Goblin Drill','Elixir Golem','Electro Giant',
      'Three Musketeers','Elixir Collector','Spirit Empress','Berserker','Goblin Curse','Goblin Machine','Void','Vines','Goblin Demolisher','Suspicious Bush','Rune Giant',
      'Archer Queen','Skeleton King','Golden Knight','Mighty Miner','Little Prince','Goblinstein'
    ];

    // --- State ---
    let state = {
      mode: 'clash', // 'clash' | 'custom'
      players: 6,
      impostors: 1,
      word: '',
      words: [],
      assignments: [],
      turn: 0,
      revealed: false,
      history: []
    };

    // --- Mode switching ---
    function applyModeUI(){
      const clash = state.mode === 'clash';
      el('title').textContent = clash ? 'Clash Imposter' : 'Custom Word Imposter';
      el('wordsLabel').textContent = clash ? 'Clash Royale cards (auto-filled)' : 'Word list (one per line)';
      el('words').disabled = clash;
      // Hide the list entirely in Clash mode
      el('wordsLabel').style.display = clash ? 'none' : '';
      el('words').style.display = clash ? 'none' : '';
      if(clash){ el('words').value = CLASH_CARDS.join('
'); }
    }

    el('modeClash').onclick = ()=>{
      state.mode='clash';
      el('modeClash').classList.add('active');
      el('modeCustom').classList.remove('active');
      applyModeUI();
    };
    el('modeCustom').onclick = ()=>{
      state.mode='custom';
      el('modeCustom').classList.add('active');
      el('modeClash').classList.remove('active');
      el('words').disabled=false;
      if(!el('words').value.trim()) el('words').value = 'pizza
volcano
rainbow';
      applyModeUI();
    };

    // --- Setup reading ---
    function readSetup(){
      const p = parseInt(el('players').value||'6');
      state.players = Math.max(3, Math.min(20, p));
      // impostors cannot exceed players
      let imp = parseInt(el('impostors').value||'1');
      imp = Math.max(1, Math.min(state.players, imp));
      state.impostors = imp;
      el('impostors').max = String(state.players);
      el('impostors').value = String(state.impostors);
      const raw = (state.mode==='clash' ? CLASH_CARDS : el('words').value.split(/
+/).map(w=>w.trim()).filter(Boolean));
      state.words = raw.length? raw : ['pizza'];
    }
    el('players').addEventListener('input', ()=>{ // keep max impostors = players
      const p = parseInt(el('players').value||'6');
      el('impostors').max = String(Math.max(1, p));
      if(parseInt(el('impostors').value||'1')>p) el('impostors').value = String(p);
    });

    function pickWord(){ state.word = state.words[Math.floor(Math.random()*state.words.length)]; }

    function assignRoles(){
      const arr = Array(state.players).fill('WORD');
      let idxs = [];
      while (idxs.length < Math.min(state.impostors, state.players)){
        const r = Math.floor(Math.random()*state.players);
        if(!idxs.includes(r)) idxs.push(r);
      }
      idxs.forEach(i=>arr[i]='IMPOSTOR');
      state.assignments = arr; state.turn=0; state.revealed=false; state.history=[];
    }

    function updatePassScreen(){
      el('turnInfo').textContent = `Player ${state.turn+1} / ${state.players}`;
      if(!state.revealed){
        el('revealText').textContent = 'Tap to reveal';
        el('revealText').style.color = 'var(--text)';
        el('hint').textContent = 'Hand the phone to this player before tapping.';
        el('toggleBtn').textContent = 'Reveal';
      } else {
        const role = state.assignments[state.turn]==='IMPOSTOR' ? 'IMPOSTOR' : state.word;
        el('revealText').textContent = role;
        el('revealText').style.color = (role==='IMPOSTOR') ? 'var(--danger)' : 'var(--text)';
        el('hint').textContent = 'Tap Next Player and pass the phone.';
        el('toggleBtn').textContent = 'Next Player';
      }
    }

    function nextTurn(){
      // record
      const role = state.assignments[state.turn];
      state.history.push({player: state.turn+1, role});
      state.turn++;
      state.revealed = false;
      if(state.turn >= state.players){
        // round over
        show('summary');
        el('summaryWord').textContent = `Word: ${state.word}`;
        const parts = state.history.map(h=>`P${h.player}: ${h.role==='IMPOSTOR'?'IMPOSTOR':'Word'}`).join(' â€¢ ');
        el('summaryList').textContent = parts;
        el('impostorReveal').classList.add('hidden');
        el('impostorReveal').textContent = '';
        return;
      }
      updatePassScreen();
    }

    // --- Handlers ---
    el('randomize').onclick = () => {
      const lines = (state.mode==='clash'?[...CLASH_CARDS]: el('words').value.split(/
+/).map(w=>w.trim()).filter(Boolean));
      for(let i=lines.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [lines[i],lines[j]]=[lines[j],lines[i]]; }
      if(state.mode==='clash') alert('Clash list shuffled for this round.');
      else el('words').value = lines.join('
');
    };

    el('start').onclick = () => { readSetup(); pickWord(); assignRoles(); show('pass'); updatePassScreen(); };

    // Single toggle button: Reveal -> Next Player
    el('toggleBtn').onclick = () => {
      if(!state.revealed){
        state.revealed = true; // show word/IMPOSTOR
        updatePassScreen();
      } else {
        nextTurn(); // hide & advance
      }
    };

    el('endRound').onclick = () => { pickWord(); assignRoles(); updatePassScreen(); };
    el('resetAll').onclick = () => { show('setup'); };

    el('playAgain').onclick = () => { pickWord(); assignRoles(); show('pass'); updatePassScreen(); };
    // Reveal impostors by tapping the summary area (word or hint)
    function revealImpostors(){
      const list = state.history.filter(h=>h.role==='IMPOSTOR').map(h=>`Player ${h.player}`).join(', ');
      el('impostorReveal').textContent = list? `Impostors: ${list}` : 'No impostors? (Check settings)';
      el('impostorReveal').classList.remove('hidden');
      el('revealHint').classList.add('hidden');
    }
    el('summaryWord').onclick = revealImpostors;
    el('revealHint').onclick = revealImpostors;
      el('impostorReveal').textContent = list? `Impostors: ${list}` : 'No impostors? (Check settings)';
      el('impostorReveal').classList.remove('hidden');
    };

    // Initialize UI
    window.addEventListener('load', ()=>{ el('words').value = CLASH_CARDS.join('
'); applyModeUI(); });
      applyModeUI();
    });
  </script>
</body>
</html>
